# Migration `20200211220527-init`

This migration has been generated by Luke Hamilton at 2/11/2020, 10:05:27 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "quaint"."User" (
    "address" TEXT NOT NULL DEFAULT '' ,
    "auth0id" TEXT NOT NULL DEFAULT '' ,
    "avatar" TEXT   ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "email" TEXT NOT NULL DEFAULT '' ,
    "firstName" TEXT   ,
    "headline" TEXT   ,
    "id" TEXT NOT NULL  ,
    "identity" TEXT   ,
    "lastName" TEXT   ,
    "name" TEXT NOT NULL DEFAULT '' ,
    "name_lower" TEXT NOT NULL DEFAULT '' ,
    "privateKey" TEXT NOT NULL DEFAULT '' ,
    "role" TEXT NOT NULL DEFAULT 'USER' ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "username" TEXT NOT NULL DEFAULT '' ,
    "username_lower" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "quaint"."Topic" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "description" TEXT   ,
    "followersCount" INTEGER   ,
    "id" TEXT NOT NULL  ,
    "image" TEXT   ,
    "name" TEXT NOT NULL DEFAULT '' ,
    "postsCount" INTEGER   ,
    "slug" TEXT NOT NULL DEFAULT '' ,
    "trending" BOOLEAN   ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "quaint"."Post" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "day" TEXT NOT NULL DEFAULT '' ,
    "description" TEXT   ,
    "featured" BOOLEAN   ,
    "id" TEXT NOT NULL  ,
    "link" TEXT   ,
    "name" TEXT   ,
    "slug" TEXT NOT NULL DEFAULT '' ,
    "submitter" TEXT NOT NULL  ,
    "tagline" TEXT   ,
    "thumbnail" TEXT   ,
    "type" TEXT NOT NULL DEFAULT 'PRODUCT' ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("submitter") REFERENCES "User"("id") ON DELETE RESTRICT
) 

CREATE TABLE "quaint"."Comment" (
    "author" TEXT NOT NULL  ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "id" TEXT NOT NULL  ,
    "parent" TEXT NOT NULL  ,
    "post" TEXT   ,
    "text" TEXT NOT NULL DEFAULT '' ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    PRIMARY KEY ("id"),FOREIGN KEY ("author") REFERENCES "User"("id") ON DELETE RESTRICT,
FOREIGN KEY ("post") REFERENCES "Post"("id") ON DELETE SET NULL,
FOREIGN KEY ("parent") REFERENCES "Comment"("id") ON DELETE RESTRICT
) 

CREATE TABLE "quaint"."CommentVote" (
    "comment" TEXT NOT NULL  ,
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "id" TEXT NOT NULL  ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "user" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("user") REFERENCES "User"("id") ON DELETE RESTRICT,
FOREIGN KEY ("comment") REFERENCES "Comment"("id") ON DELETE RESTRICT
) 

CREATE TABLE "quaint"."Vote" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "id" TEXT NOT NULL  ,
    "post" TEXT NOT NULL  ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "user" TEXT NOT NULL  ,
    PRIMARY KEY ("id"),FOREIGN KEY ("user") REFERENCES "User"("id") ON DELETE RESTRICT,
FOREIGN KEY ("post") REFERENCES "Post"("id") ON DELETE RESTRICT
) 

CREATE TABLE "quaint"."Section" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "date" TEXT NOT NULL DEFAULT '' ,
    "id" TEXT NOT NULL  ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "quaint"."SignedUpload" (
    "createdAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "id" TEXT NOT NULL  ,
    "signedRequest" TEXT NOT NULL DEFAULT '' ,
    "updatedAt" DATE NOT NULL DEFAULT '1970-01-01 00:00:00' ,
    "url" TEXT NOT NULL DEFAULT '' ,
    PRIMARY KEY ("id")
) 

CREATE TABLE "quaint"."_follows" (
    "A" TEXT NOT NULL  ,
    "B" TEXT NOT NULL  ,FOREIGN KEY ("A") REFERENCES "User"("id") ON DELETE CASCADE,
FOREIGN KEY ("B") REFERENCES "User"("id") ON DELETE CASCADE
) 

CREATE TABLE "quaint"."_CreatedPosts" (
    "A" TEXT NOT NULL  ,
    "B" TEXT NOT NULL  ,FOREIGN KEY ("A") REFERENCES "Post"("id") ON DELETE CASCADE,
FOREIGN KEY ("B") REFERENCES "User"("id") ON DELETE CASCADE
) 

CREATE TABLE "quaint"."_TopicToUser" (
    "A" TEXT NOT NULL  ,
    "B" TEXT NOT NULL  ,FOREIGN KEY ("A") REFERENCES "Topic"("id") ON DELETE CASCADE,
FOREIGN KEY ("B") REFERENCES "User"("id") ON DELETE CASCADE
) 

CREATE TABLE "quaint"."_PostToTopic" (
    "A" TEXT NOT NULL  ,
    "B" TEXT NOT NULL  ,FOREIGN KEY ("A") REFERENCES "Post"("id") ON DELETE CASCADE,
FOREIGN KEY ("B") REFERENCES "Topic"("id") ON DELETE CASCADE
) 

CREATE TABLE "quaint"."_PostToSection" (
    "A" TEXT NOT NULL  ,
    "B" TEXT NOT NULL  ,FOREIGN KEY ("A") REFERENCES "Post"("id") ON DELETE CASCADE,
FOREIGN KEY ("B") REFERENCES "Section"("id") ON DELETE CASCADE
) 

CREATE UNIQUE INDEX "quaint"."User.email" ON "User"("email")

CREATE UNIQUE INDEX "quaint"."User.username" ON "User"("username")

CREATE UNIQUE INDEX "quaint"."User.username_lower" ON "User"("username_lower")

CREATE UNIQUE INDEX "quaint"."User.auth0id" ON "User"("auth0id")

CREATE UNIQUE INDEX "quaint"."Topic.slug" ON "Topic"("slug")

CREATE UNIQUE INDEX "quaint"."Post.slug" ON "Post"("slug")

CREATE UNIQUE INDEX "quaint"."Section.date" ON "Section"("date")

CREATE UNIQUE INDEX "quaint"."_follows_AB_unique" ON "_follows"("A","B")

CREATE UNIQUE INDEX "quaint"."_CreatedPosts_AB_unique" ON "_CreatedPosts"("A","B")

CREATE UNIQUE INDEX "quaint"."_TopicToUser_AB_unique" ON "_TopicToUser"("A","B")

CREATE UNIQUE INDEX "quaint"."_PostToTopic_AB_unique" ON "_PostToTopic"("A","B")

CREATE UNIQUE INDEX "quaint"."_PostToSection_AB_unique" ON "_PostToSection"("A","B")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200211220527-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,124 @@
+
+datasource db {
+  provider = "sqlite"
+  url      = "sqlite:./dev.db"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model User {
+  id               String   @default(cuid()) @id
+  createdAt        DateTime @default(now())
+  updatedAt        DateTime @updatedAt
+  email            String   @unique
+  role             Role     @default(USER)
+  firstName        String?
+  lastName         String?
+  name             String
+  name_lower       String
+  username         String   @unique
+  username_lower   String   @unique
+  headline         String?
+  avatar           String?
+  auth0id          String   @unique
+  identity         String?
+  privateKey       String
+  follows          User[]  @relation(name: "follows")
+  followedBy       User[]  @relation(name: "follows")
+  address          String
+  submittedPosts   Post[]   @relation(name: "SubmittedPosts")
+  createdPosts     Post[]   @relation(name: "CreatedPosts")
+  followedTopics   Topic[]
+}
+
+model Topic {
+  id             String   @default(cuid()) @id
+  createdAt      DateTime @default(now())
+  updatedAt      DateTime @updatedAt
+  name           String
+  slug           String   @unique
+  description    String?
+  image          String?
+  followersCount Int?
+  postsCount     Int?
+  trending       Boolean?
+  posts          Post[]
+  followedBy     User[]
+}
+
+model Post {
+  id            String    @default(cuid()) @id
+  createdAt     DateTime  @default(now())
+  updatedAt     DateTime  @updatedAt
+  type          PostType  @default(PRODUCT)
+  name          String?
+  slug          String    @unique
+  link          String?   
+  thumbnail     String?   
+  description   String?   
+  tagline       String?   
+  submitter     User      @relation(name: "SubmittedPosts")
+  creators      User[]    @relation(name: "CreatedPosts")
+  comments      Comment[] 
+  day           String
+  featured      Boolean?
+  topics        Topic[]
+  votes         Vote[]
+  sections      Section[]
+}
+
+model Comment {
+  id            String         @default(cuid()) @id
+  createdAt     DateTime       @default(now())
+  updatedAt     DateTime       @updatedAt
+  text          String             
+  author        User
+  post          Post?
+  parent        Comment        @relation(name: "commentReplies")
+  replies       Comment[]      @relation(name: "commentReplies")
+  votes         CommentVote[]
+}
+
+model CommentVote {
+  id            String   @default(cuid()) @id
+  createdAt     DateTime @default(now())
+  updatedAt     DateTime @updatedAt
+  user          User
+  comment       Comment
+}
+
+model Vote {
+  id            String   @default(cuid()) @id
+  createdAt     DateTime @default(now())
+  updatedAt     DateTime @updatedAt
+  user          User
+  post          Post
+}
+
+model Section {
+  id            String   @default(cuid()) @id
+  createdAt     DateTime @default(now())
+  updatedAt     DateTime @updatedAt
+  date          String   @unique
+  posts         Post[]
+}
+
+model SignedUpload {
+  id            String   @default(cuid()) @id
+  createdAt     DateTime @default(now())
+  updatedAt     DateTime @updatedAt
+  signedRequest String
+  url           String
+}
+
+enum Role {
+  ADMIN
+  USER
+}
+
+enum PostType {
+  PRODUCT
+  LINK
+}
```


